{% extends "base.html" %}{% load staticfiles %}

{% block title %}Stats{% endblock %}

<!-- BLOCK HEAD -->
{% block head %}
  <link rel="stylesheet" href="{% static 'detail.css' %}">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

  <style>
    .chart {
      margin-left: -20px;
      width: 900px;
      height: 500px;
    }
  </style>









{% endblock %}
<!-- /BLOCK HEAD -->

<!-- BLOCK CONTENT -->
{% block content %}
  <h1>Stats</h1>

  <p id="stats-blue-row"></p>
  <p id="stats-red-row"></p>

  <div id='chart_div' class='chart'></div>


  <h2>Legg timer til prosjekt her</h2>

  <!--Add hours to project: First line  -->

  <hr class="hrStyle">
  <div id="line1">

    <!-- Add date -->
    <div class="addElement">
      <label class="addLabel" for="date1">Velg dato:</label>
      <input type="date" name="date1" id="date1" class="form1">
    </div>

    <!-- Add project -->
    <div class=" addElement">
      <label class="addLabel"> Velg prosjekt: </label>
      <select id="project1" class="dropdown addProject form1">
        <option value="project1.1">Prosjekt 1</option>
        <option value="project1.2">Prosjekt 2</option>
        <option value="project1.3">Prosjekt 3</option>
        <option value="project1.4">Prosjekt 4</option>
      </select>
    </div>

    <!-- Add sub-project -->
    <div class=" addElement">
      <label class="addLabel"> Velg delprosjekt: </label>
      <select id="sProject1" class="dropdown addProject form1">
        <option value="sProject1.0">Alle</option>
        <option value="sProject1.1">Delprosjekt 1</option>
        <option value="sProject1.2">Delprosjekt 2</option>
        <option value="sProject1.3">Delprosjekt 3</option>
        <option value="sProject1.4">Delprosjekt 4</option>
      </select>
    </div>

    <!-- Add hours -->
    <div class="addElement">
      <label class="addLabel"> Antall timer: </label>
      <div class="col-xs-1 addHours">
        <div class="input-group spinner addHoursInput">
          <input id="hours1" type="text" maxlength="2" class="form-control" value="0" min="0" max="24">
          <div class="input-group-btn-vertical">
            <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
            <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add note -->
    <div class="addElement">
      <label class="addLabel">Legg til merknad:</label>
      <textarea id="note1" type="text" class="form1 form2" maxlength="75"></textarea>
    </div>

    <hr class="hrStyle">
  </div>




  <!--Add hours to project: Second line  -->
  <div id="line2" style="display:none">


    <!-- Add date -->
    <div class="addElement">
      <label class="addLabel" for="date2">Velg dato:</label>
      <input type="date" name="date2" id="date2" class="form1">
    </div>

    <!-- Add project -->
    <div class=" addElement">
      <label class="addLabel"> Velg prosjekt: </label>
      <select id="project2" class="dropdown addProject form1">
        <option value="project2.1">Prosjekt 1</option>
        <option value="project2.2">Prosjekt 2</option>
        <option value="project2.3">Prosjekt 3</option>
        <option value="project2.4">Prosjekt 4</option>
      </select>
    </div>

    <!-- Add sub-project -->
    <div class=" addElement">
      <label class="addLabel"> Velg delprosjekt: </label>
      <select id="sProject2" class="dropdown addProject form1">
        <option value="sProject2.0">Alle</option>
        <option value="sProject2.1">Delprosjekt 1</option>
        <option value="sProject2.2">Delprosjekt 2</option>
        <option value="sProject2.3">Delprosjekt 3</option>
        <option value="sProject2.4">Delprosjekt 4</option>
      </select>
    </div>


    <!-- Add hours -->
    <div class="addElement">
      <label class="addLabel"> Antall timer: </label>
      <div class="col-xs-1 addHours">
        <div class="input-group spinner addHoursInput">
          <input id="hours2" type="text" class="form-control" value="0" min="0" max="24">
          <div class="input-group-btn-vertical">
            <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
            <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add note -->
    <div class="addElement">
      <label class="addLabel">Legg til merknad:</label>
      <textarea id="note2" type="text" class="form1 form2" maxlength="75"></textarea>
    </div>

    <hr class="hrStyle">
  </div>




  <!--Add hours to project: Third line  -->
  <div id="line3" style="display:none">


    <!-- Add date -->
    <div class="addElement">
      <label class="addLabel" for="date3">Velg dato:</label>
      <input type="date" name="date3" id="date3" class="form1">
    </div>

    <!-- Add project -->
    <div class=" addElement">
      <label class="addLabel"> Velg prosjekt: </label>
      <select id="project3" class="dropdown addProject form1">
        <option value="project3.1">Prosjekt 1</option>
        <option value="project3.2">Prosjekt 2</option>
        <option value="project3.3">Prosjekt 3</option>
        <option value="project3.4">Prosjekt 4</option>
      </select>
    </div>

    <!-- Add sub-project -->
    <div class=" addElement">
      <label class="addLabel"> Velg delprosjekt: </label>
      <select id="sProject3" class="dropdown addProject form1">
        <option value="sProject3.0">Alle</option>
        <option value="sProject3.1">Delprosjekt 1</option>
        <option value="sProject3.2">Delprosjekt 2</option>
        <option value="sProject3.3">Delprosjekt 3</option>
        <option value="sProject3.4">Delprosjekt 4</option>
      </select>
    </div>


    <!-- Add hours -->
    <div class="addElement">
      <label class="addLabel"> Antall timer: </label>
      <div class="col-xs-1 addHours">
        <div class="input-group spinner addHoursInput">
          <input id="hours3" type="text" class="form-control" value="0" min="0" max="24">
          <div class="input-group-btn-vertical">
            <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
            <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add note -->
    <div class="addElement">
      <label class="addLabel">Legg til merknad:</label>
      <textarea id="note3" type="text" class="form1 form2" maxlength="75"></textarea>
    </div>

    <hr class="hrStyle">
  </div>





  <!--Add hours to project: Fourth line  -->
  <div id="line4" style="display:none">

    <!-- Add date -->
    <div class="addElement">
      <label class="addLabel" for="date4">Velg dato:</label>
      <input type="date" name="date4" id="date4" class="form1">
    </div>

    <!-- Add project -->
    <div class=" addElement">
      <label class="addLabel"> Velg prosjekt: </label>
      <select id="project4" class="dropdown addProject form1">
        <option value="project4.1">Prosjekt 1</option>
        <option value="project4.2">Prosjekt 2</option>
        <option value="project4.3">Prosjekt 3</option>
        <option value="project4.4">Prosjekt 4</option>
      </select>
    </div>

    <!-- Add sub-project -->
    <div class=" addElement">
      <label class="addLabel"> Velg delprosjekt: </label>
      <select id="sProject4" class="dropdown addProject form1">
        <option value="sProject4.0">Alle</option>
        <option value="sProject4.1">Delprosjekt 1</option>
        <option value="sProject4.2">Delprosjekt 2</option>
        <option value="sProject4.3">Delprosjekt 3</option>
        <option value="sProject4.4">Delprosjekt 4</option>
      </select>
    </div>

    <!-- Add hours -->
    <div class="addElement">
      <label class="addLabel"> Antall timer: </label>
      <div class="col-xs-1 addHours">
        <div class="input-group spinner addHoursInput">
          <input id="hours4" type="text" class="form-control" value="0" min="0" max="24">
          <div class="input-group-btn-vertical">
            <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
            <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add note -->
    <div class="addElement">
      <label class="addLabel">Legg til merknad:</label>
      <textarea id="note4" type="text" class="form1 form2" maxlength="75"></textarea>
    </div>

    <hr class="hrStyle">
  </div>




  <!--Add hours to project: Fifth line  -->
  <div id="line5" style="display:none">

    <!-- Add date -->
    <div class="addElement">
      <label class="addLabel" for="date5">Velg dato:</label>
      <input type="date" name="date5" id="date5" class="form1">
    </div>

    <!-- Add project -->
    <div class=" addElement">
      <label class="addLabel"> Velg prosjekt: </label>
      <select id="project5" class="dropdown addProject form1">
        <option value="project5.1">Prosjekt 1</option>
        <option value="project5.2">Prosjekt 2</option>
        <option value="project5.3">Prosjekt 3</option>
        <option value="project5.4">Prosjekt 4</option>
      </select>
    </div>

    <!-- Add sub-project -->
    <div class=" addElement">
      <label class="addLabel"> Velg delprosjekt: </label>
      <select id="sProject5" class="dropdown addProject form1">
        <option value="sProject5.0">Alle</option>
        <option value="sProject5.1">Delprosjekt 1</option>
        <option value="sProject5.2">Delprosjekt 2</option>
        <option value="sProject5.3">Delprosjekt 3</option>
        <option value="sProject5.4">Delprosjekt 4</option>
      </select>
    </div>

    <!-- Add hours -->
    <div class="addElement">
      <label class="addLabel"> Antall timer: </label>
      <div class="col-xs-1 addHours">
        <div class="input-group spinner addHoursInput">
          <input id="hours5" type="text" class="form-control" value="0" min="0" max="24">
          <div class="input-group-btn-vertical">
            <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
            <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add note-->
    <div class="addElement">
      <label class="addLabel">Legg til merknad:</label>
      <textarea id="note5" type="text" class="form1 form2" maxlength="75"></textarea>
    </div>

    <hr class="hrStyle">
  </div>



  <!--Add hours to project: Buttons -->

  <div id="line6">

    <!-- Button with minus-sign -->
    <div class="addElement">
      <button type="button" class="btn btn-default btnSign" id="btnMinus"><i class="fa fa-minus btnSignInside" aria-hidden="true"></i></button>

      <!-- Button with plus-sign -->
      <button type="button" class="btn btn-default btnSign" id="btnPlus"><i class="fa fa-plus btnSignInside" aria-hidden="true"></i></button>
    </div>

    <!-- Submit button -->
    <div class="addElement">
      <button type="button" class="btn btn-default" id="btnSubmitHours"><span class="btnSignInside" aria-hidden="true">Legg til timer</span></button>
    </div>

    <hr class="hrStyle">
  </div>
  </body>



{% endblock %}
<!-- /BLOCK CONTENT -->

<!-- BLOCK DOMREADY  // LIGGER I 'base.html'-->
{% block domready %}


      //Add Hours
      // Form functionality
      $(function () {

          $('.spinner .btn:first-of-type').on('click', function () {
              var btn = $(this);
              var input = btn.closest('.spinner').find('input');
              if (input.attr('max') == undefined || parseInt(input.val()) < parseInt(input.attr('max'))) {
                  input.val(parseInt(input.val(), 10) + 1);
              } else {
                  btn.next("disabled", true);
              }
          });
          $('.spinner .btn:last-of-type').on('click', function () {
              var btn = $(this);
              var input = btn.closest('.spinner').find('input');
              if (input.attr('min') == undefined || parseInt(input.val()) > parseInt(input.attr('min'))) {
                  input.val(parseInt(input.val(), 10) - 1);
              } else {
                  btn.prev("disabled", true);
              }
          });

      })

      // Add and remove lines -variables
      var x = 2;
      var btnP = document.getElementById('btnPlus');
      var btnM = document.getElementById('btnMinus');
      var btnSH = document.getElementById('btnSubmitHours');

      // Add line

      btnP.onclick = function () {
          if (x > 0 || x < 6) {
              var id = "line" + x;
              document.getElementById(id).style.display = "block";
              x++;
          }
          if (x == 6) {
              btnP.disabled = true;
              btnP.style.opacity = "0.5";
              btnP.style.cursor = "default";
          }

          if (btnM.disabled == true) {
              btnM.disabled = false;
              btnM.style.opacity = "1";
              btnM.style.cursor = "pointer";

              btnSH.disabled = false;
              btnSH.style.opacity = "1";
              btnSH.style.cursor = "pointer";
          }
          window.scroll(0, findPos(btnSH));
      };

      // Remove line
      btnM.onclick = function () {
          x--;
          resetForm();
          if (x > 1 || x < 7) {
              var id = "line" + x;
              document.getElementById(id).style.display = "none";

          }
          if (x == 1) {
              btnM.disabled = true;
              btnM.style.opacity = "0.5";
              btnM.style.cursor = "default";

              btnSH.disabled = true;
              btnSH.style.opacity = "0.5";
              btnSH.style.cursor = "default";

          }
          if (btnP.disabled == true) {
              btnP.disabled = false;
              btnP.style.opacity = "1";
              btnP.style.cursor = "pointer";
          }

      };


      function resetForm() {
          document.getElementById("date" + x).value = "";
          document.getElementById("project" + x).selectedIndex = "0";
          document.getElementById("sProject" + x).selectedIndex = "0";
          document.getElementById("hours" + x).value = "0";
          document.getElementById("note" + x).value = "";


      }

      //Finds y value of given object
      function findPos(obj) {
          var curtop = 0;
          if (obj.offsetParent) {
              do {
                  curtop += obj.offsetTop;
              } while (obj = obj.offsetParent);
              return [curtop];
          }
      }
      //
      <!-- STATS GOOGLE GRAPH -->
      google.charts.load('current', {'packages': ['annotationchart']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
          var data = new google.visualization.DataTable();
          data.addColumn('date', 'Date');
          data.addColumn('number', 'Prosjekt 1');
          data.addColumn('string', 'Prosjekt 1 title');
          data.addColumn('string', 'Prosjekt 1 text');
          data.addColumn('number', 'Prosjekt 2');
          data.addColumn('string', 'Prosjekt 2 title');
          data.addColumn('string', 'Prosjekt 2 text');
          data.addRows([
              [new Date(2017, 6, 15), 0, 'Prosjekt 1', 'Prosjekt oppstart',
                  undefined, undefined, undefined
              ],
              [new Date(2017, 6, 16), 5, 'Prosjekt 1', 'Planleggingsmøte',
                  0, 'Prosjekt 2', 'Prosjekt oppstart'
              ],
              [new Date(2017, 6, 17), 5, 'Prosjekt 1', 'Første jobbdag',
                  2, 'Prosjekt 2', 'Møte med oppdragsgiver'
              ],
              [new Date(2017, 6, 18), 3, undefined, undefined,
                  4, undefined, undefined
              ],
              [new Date(2017, 6, 19), 7, undefined, undefined,
                  1, undefined, undefined
              ],
              [new Date(2017, 6, 20), 2, 'Prosjekt 1', 'Prosjekt ferdig',
                  9, 'Prosjekt 2', 'Siste møte'
              ],
              [new Date(2017, 6, 21), undefined, undefined, undefined,
                  3, 'Prosjekt 2', 'Prosjekt ferdig'
              ],
              [new Date(2017, 6, 22), undefined, undefined, undefined,
                  undefined, undefined, undefined
              ]
          ]);


          var chart = new google.visualization.AnnotationChart(document.getElementById('chart_div'));

          var options = {
              displayAnnotations: true
          };

          chart.draw(data, options);

          var pBlue = $('p#stats-blue-row');
          var pRed = $('p#stats-red-row');

          var totalBlue = 0;
          var totalRed = 0;
          for (var row = 0; row < data.getNumberOfRows(); row++) {
              // Red Graph
              totalRed += data.getValue(row, 4);
              // Blue Graph
              totalBlue += data.getValue(row, 1);
          }
          pRed.text("Red Data: " + parseInt(totalRed));
          pBlue.text("Blue Data: " + parseInt(totalBlue));
      }
      // <!-- /STATS GOOGLE GRAPH -->
{% endblock %}
<!-- /BLOCK DOMREADY -->
